# アクセス権

安全な住所の伝達をするためにはアクセス権の設計が重要です。
そもそも、登場人物にはどのような役割があり、どのような権限が必要なのでしょう。

## Read権

Read権は、**実住所を読める** 権限で、当然セキュリティ的に一番重要な権限です。
安全なシステムにするには、この権限を与える登場人物を **必要最小限** にすることが大事です。
実住所が読めるのは、実住所にアクセスする必要がある人だけです。
さてそれはどのような人でしょう。

ECサイトでしょうか? 友人でしょうか? 違います。
ECサイトは直接家にアクセスしてきませんし、友人を招きたかったら駅まで出迎えればよいのです。
実住所にアクセスする必要がある人というのは、 **郵便・配送業** や **水道修理業者** のような、
 **家のピンポンを実際に押す人** を考えると良いと思います。

さらに、配送業者にも **実際に家に配送に来る人** と、拠点から拠点へ荷物を運ぶ人などの様々な役割があります。
この場合、実際に家に配送に来る人のみに実住所のRead権を与えるべきで、
拠点間移動のためには市町村までのような **制限されたRead権** の仕組みがあるべきでしょう。
配送スタッフが持つデバイスと拠点備え付けのデバイスで、別々の認証情報を持つなどの対応が必要でしょう。

なお、「友人に家の場所を教える」や、「水道修理業者を呼ぶ」場合、おそらく **位置情報** による伝達が主流になっていくでしょう。
救急車なども位置情報になり、通報しているデバイスの位置を常にトラッキングし目指すようになり、不正が不可能になると思われます。
そもそも、**実住所と言っているものが文字列ではなく座標になる** 可能性は大いにあります。

このような状態になったとしても、配送先の指定に住所トークンを強制することで、
**位置情報では郵便は送れない** ことになり、**場所を知っている != 住所が利用できる** という構造が確立していくものと思われます。

## Write権

Write権は、**実住所をデータベースに書き込む** 権限です。
これは、 **不動産屋** のみが書き込めればいいでしょう。
家の契約をしたタイミングで、不動産屋に対して自分のアカウントのWrite権を付与します。
不動産屋はこの権限を以て不動産屋だけが知っている文字列の実住所をデータベースに書き込みます。
家に住む本人は、実住所を知る必要がありません。

## トークン発行権

トークン発行権は、その名の通り住所トークンを発行する権利です。
当然発行できるのは本人のみ・・・・**ではありません**。

トークン発行権を本人のみにしてしまうと、住所トークンが必要なシーンで **常に本人が発行** しないといけなくなります。
例えばECサイトを考えたとき、買い物のたびにわざわざ毎回自分で住所トークンを発行しないといけません。
非常に非効率ですし、もちろん自動化もできません。
自動化できなければシステム化した意味がないし、あらゆるECサイトは滅亡するでしょう。

そのため、ECサイトにトークン発行権を **移譲** し、ECサイトの権限でユーザの住所トークンを発行できるようにします。
このトークン発行権の移譲こそこのシステムの肝となる機能です。
トークン発行権を **永続的に** 移譲されるのは、継続的に住所を利用する可能性がある登場人物です。
例えば上記のようなECサイトや、所属する会社、実家の親などが挙げられます。
もちろん、権限の移譲を失効させることもできなくてはいけません。
